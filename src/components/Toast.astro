---
import { CheckCircle2, AlertCircle } from 'lucide-astro';
---

<div id="toast-container" class="fixed top-24 left-1/2 -translate-x-1/2 z-[100] pointer-events-none px-6 w-full max-w-md">
  <div id="toast" class="opacity-0 translate-y-[-20px] transition-all duration-500 ease-out flex items-center gap-4 p-5 rounded-2xl backdrop-blur-xl border border-transparent pointer-events-auto shadow-2xl">
    <div id="toast-icon-container" class="flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center text-white shadow-lg">
      <div id="toast-icon-success" class="hidden"><CheckCircle2 size={24} /></div>
      <div id="toast-icon-error" class="hidden"><AlertCircle size={24} /></div>
    </div>
    <div class="flex-1">
      <p id="toast-message" class="font-black text-sm uppercase tracking-wider"></p>
    </div>
  </div>
</div>

<script is:inline>
  window.showToast = (message, type = 'success') => {
    const toast = document.getElementById('toast');
    const msgEl = document.getElementById('toast-message');
    const iconContainer = document.getElementById('toast-icon-container');
    const successIcon = document.getElementById('toast-icon-success');
    const errorIcon = document.getElementById('toast-icon-error');
    
    if (toast && msgEl && iconContainer) {
      msgEl.textContent = message;
      
      // Reset classes while preserving the base animation classes
      toast.className = 'opacity-0 translate-y-[-20px] transition-all duration-500 ease-out flex items-center gap-4 p-5 rounded-2xl backdrop-blur-xl border pointer-events-auto shadow-2xl';
      iconContainer.className = 'flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center text-white shadow-lg';
      successIcon.classList.add('hidden');
      errorIcon.classList.add('hidden');

      if (type === 'success') {
        toast.classList.add('bg-green-500/20', 'border-green-500/30', 'shadow-green-500/20');
        iconContainer.classList.add('bg-green-500', 'shadow-green-500/40');
        msgEl.className = 'font-black text-sm uppercase tracking-wider text-green-950';
        successIcon.classList.remove('hidden');
      } else {
        toast.classList.add('bg-red-500/20', 'border-red-500/30', 'shadow-red-500/20');
        iconContainer.classList.add('bg-red-500', 'shadow-red-500/40');
        msgEl.className = 'font-black text-sm uppercase tracking-wider text-red-950';
        errorIcon.classList.remove('hidden');
      }
      
      // Force a reflow to ensure the transition triggers
      toast.offsetHeight;

      // Trigger animation
      toast.classList.remove('opacity-0', 'translate-y-[-20px]');
      toast.classList.add('opacity-100', 'translate-y-0');
      
      // Auto-hide
      if (window.toastTimeout) clearTimeout(window.toastTimeout);
      window.toastTimeout = setTimeout(() => {
        toast.classList.add('opacity-0', 'translate-y-[-20px]');
        toast.classList.remove('opacity-100', 'translate-y-0');
      }, 5000);
    } else {
      console.error('Toast elements not found');
      alert(message);
    }
  };
</script>

<style>
  #toast {
    transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
</style>
